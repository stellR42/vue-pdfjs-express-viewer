/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[16],{335:function(Ca,va,aa){function pa(h,y,ba){y.endsWith("/")||(y+="/");ba=ba||{};var ka=ba.disableWebsockets||!1;this.wP=ba.singleServerMode||!1;null!=ba.customQueryParameters&&Object(f.b)("wvsQueryParameters",ba.customQueryParameters);y.endsWith("blackbox/")||(y+="blackbox/");this.kl=ba.uploadData||null;this.Lt=ba.uriData||null;this.KI=ba.cacheKey||null;this.DM=ba.officeLocale||null;this.fB=Object(r.a)(y,null,ka);this.se=y;this.uB=
h;this.Fe=null;this.$h=ja();this.mk=ja();this.Wv=!1;this.pf=this.fd=this.wd=this.re=null;this.Ke=[];this.Aw=[];this.cache={};this.timeStamp=0;this.af=[];this.eg=[];this.MB=null;this.oB=!1;this.GE=this.id=null;this.oD=this.mL=la;this.Cy=0;this.HC=!1;this.xM=1;this.Rh={};this.qn(!0)}function ja(){var h={promise:null,resolve:null,reject:null,state:0,result:null,request:null,bp:function(){return 1===(h.state&1)},g1:function(){return 2===(h.state&2)},Mg:function(){return!h.g1()&&!h.bp()},M0:function(){return 4===
(h.state&4)},QO:function(){h.state|=4}};h.promise=new Promise(function(y,ba){h.resolve=function(){if(0===h.state||4===h.state)h.state=1,h.result=arguments[0],y.apply(null,arguments)};h.reject=function(){if(0===h.state||4===h.state)h.state=2,ba.apply(null,arguments)}});return h}function la(){return!1}function fa(h,y,ba){if(!(y in n))return!0;y=n[y];for(var ka=0;ka<y.length;ka++){var ha=h;var ia=y[ka];var ea=ba;if(ia.name in ha){var oa="",sa=!1;ha=ha[ia.name];switch(ia.type){case "s":oa="String";sa=
Object(ca.isString)(ha);break;case "a":oa="Array";sa=Object(ca.isArray)(ha);break;case "n":oa="Number";sa=Object(ca.isNumber)(ha)&&Object(ca.isFinite)(ha);break;case "o":oa="Object",sa=Object(ca.isObject)(ha)&&!Object(ca.isArray)(ha)}sa||ea.reject('Expected response field "'+ia.name+'" to have type '+oa);ia=sa}else ea.reject('Response missing field "'+ia.name+'"'),ia=!1;if(!ia)return!1}return!0}aa.r(va);var ca=aa(0);aa.n(ca);var z=aa(1);Ca=aa(44);var w=aa(31),r=aa(353),b=aa(70),a=aa(283),e=aa(92),
f=aa(37),x=aa(126),n={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],ApString2Xod:[{name:"url",type:"s"},{name:"rID",type:"s"}]};
pa.prototype=Object(ca.extend)(pa.prototype,{AW:function(){var h=this;return new Promise(function(y,ba){var ka=new XMLHttpRequest;ka.open("GET",h.se+"ck");ka.withCredentials=h.Yi();ka.onreadystatechange=function(){ka.readyState===XMLHttpRequest.DONE&&(200===ka.status?y():ba())};ka.send()})},u6:function(h,y){this.mL=h||la;this.oD=y||la},$I:function(){var h=this;this.mk=ja();this.$h=ja();return this.fB.CB().then(function(){h.Wv=!1;h.id=null;h.oB=!1;return h.AW()})},rE:function(){this.mL();this.VC();
this.re&&(this.re.Mg()?this.Ge(this.re.request):this.re.bp()&&this.oD(this.re.result.url,"pdf")&&(this.re=null,this.rO()));this.pf&&this.pf.Mg()&&this.Ge(this.pf.request);this.wd&&this.wd.Mg()?this.Ge(this.wd.request):this.fd&&this.fd.Mg()&&this.cL(this.fd.request);var h;for(h=0;h<this.af.length;h++)this.af[h]&&this.af[h]&&(this.af[h].Mg()?this.Ge(this.af[h].request):this.af[h].bp()&&this.oD(this.af[h].result.url,"image")&&(this.af[h]=null,this.zy(h)));for(h=0;h<this.eg.length;h++)this.eg[h]&&this.eg[h]&&
this.eg[h].Mg()&&!this.eg[h].M0()&&this.Ge(this.eg[h].request);for(h=0;h<this.Ke.length;h++)this.Ke[h]&&this.Ke[h].Mg()&&this.Ge(this.Ke[h].request)},VC:function(h){var y=this;this.Wv||(this.timeStamp=Date.now(),this.fB.gF(function(ba){y.z2(ba)},function(){return null},function(){return null},!0).then(function(){clearInterval(y.ry);y.ry=null},function(ba){y.Wv=!1;if(!y.ry){var ka=0;y.oB=!0;y.GE=0;y.ry=setInterval(function(){2>ka++?y.rE():(clearInterval(y.ry),h&&h.reject(e.a),Object(z.f)("WebViewerServer connection failed:"+
ba))},5E3)}}),this.Wv=!0)},u8:function(){var h=this,y=createPromiseCapability();if(this.kl){var ba=new FormData;ba.append("file",this.kl.fileHandle,this.kl.fileHandle.name);var ka=this.kl.loadCallback;var ha="upload";var ia=this.kl.extension}else if(this.Lt){ba={uri:this.Lt.uri,Hda:this.Lt.shareId};ba=Object.keys(ba).map(function(na){return na+"="+(ba[na]?encodeURIComponent(ba[na]):"")}).join("&");var ea="application/x-www-form-urlencoded; charset=UTF-8";ka=this.Lt.loadCallback;ha="url";ia=this.Lt.extension}else return Promise.resolve();
var oa=new XMLHttpRequest,sa=Object(w.h)(h.se,"AuxUpload");sa=Object(x.a)(sa)+"&type="+ha+"&ext="+ia;oa.open("POST",sa);oa.withCredentials=this.Yi();ea&&oa.setRequestHeader("Content-Type",ea);oa.addEventListener("load",function(){if(oa.readyState===oa.DONE&&200===oa.status){var na=JSON.parse(oa.response);h.uB=na.uri;ka(na);y.resolve(na)}});oa.addEventListener("error",function(){y.reject(oa.statusText+" "+JSON.stringify(oa))});this.kl&&null!=this.kl.onProgress&&(oa.upload.onprogress=function(na){h.kl.onProgress(na)});
oa.send(ba);return y.promise},k5:function(h){this.password=h||null;this.$h.bp()||(this.$h=ja(),this.Ge({t:"pages"}));return this.$h.promise},ct:function(h){this.MB=h||null;this.$h.bp()||(this.VC(this.$h),this.Ge({t:"pages"}));return this.$h.promise},dB:function(h){h=Object.assign(h,{uri:encodeURIComponent(this.uB)});this.MB&&(h.ext=this.MB);this.Fe&&(h.c=this.Fe);this.password&&(h.pswd=this.password);this.KI&&(h.cacheKey=this.KI);this.DM&&(h.locale=this.DM);return h},Ge:function(h){h=this.dB(h);this.fB.send(h)},
Mi:function(h){return h},z2:function(h){var y=this,ba=h.data,ka=h.err,ha=h.t;switch(ha){case "upload":ka?y.v8.reject(ka):y.v8.resolve("Success");break;case "pages":ka?y.$h.reject(ka):fa(ba,ha,y.$h)&&y.$h.resolve(ba);break;case "config":if(ka)y.mk.reject(ka);else if(fa(ba,ha,y.mk)){ba.id&&(y.id=ba.id);if(ba.auth){var ia=Object(f.a)("wvsQueryParameters");ia.auth=ba.auth;Object(f.b)("wvsQueryParameters",ia)}ba.serverVersion&&(y.M8=ba.serverVersion,Object(z.g)("[WebViewer Server] server version: "+y.M8));
ba.serverID?(y.Cy=ba.serverID===y.GE&&y.HC?y.Cy+1:0,y.GE=ba.serverID):y.Cy=0;y.HC=!1;y.mk.resolve(ba)}break;case "health":ka?y.mk.reject(ka):fa(ba,ha,y.mk)&&(ba=ba.unhealthy,y.wP&&ba?Object(z.i)("Server failed health check. Single server mode ignoring check."):!y.iaa&&ba&&1>=y.Cy&&(y.HC=!0,y.$I().then(function(){y.rE()},function(){y.rE()})));break;case "pdf":ba.url=Object(x.a)(y.se+"../"+encodeURI(ba.url));ka?y.re.reject(ka):fa(ba,ha,y.re)&&y.re.resolve(ba);break;case "ApString2Xod":ba.url=Object(x.a)(y.se+
"../data/"+encodeURI(ba.url));ka?y.Rh[ba.rID].reject(ka):fa(ba,ha,y.Rh[ba.rID])&&y.Rh[ba.rID].resolve(ba);break;case "docmod":ba.url=Object(x.a)(y.se+"../"+encodeURI(ba.url));ka?y.Rh[ba.rID].reject(ka):fa(ba,ha,y.re)&&y.Rh[ba.rID].resolve(ba);break;case "xod":if(ka)this.wd&&this.wd.Mg()&&this.wd.reject(ka),this.fd&&this.fd.Mg()&&this.fd.reject(ka);else if(ba.notFound)ba.noCreate||this.wd&&this.wd.Mg()&&this.wd.resolve(ba),this.fd&&this.fd.Mg()&&this.fd.resolve(ba);else{ba.url&&(ba.url=Object(x.a)(y.se+
"../"+encodeURI(ba.url)));if(!this.fd||this.fd.bp())this.fd=ja(),this.fd.request={t:"xod",noCreate:!0};this.wd||(this.wd=ja(),this.wd.request={t:"xod"});this.fd.resolve(ba);this.wd.resolve(ba)}break;case "annots":if(ka)y.pf.reject(ka);else if(fa(ba,ha,y.pf)){y.pf.QO();var ea=new XMLHttpRequest;ia=y.se+"../"+encodeURI(ba.url);var oa=ba.hasAppearance?Object(x.a)(ia+".xodapp"):null;ea.open("GET",Object(x.a)(ia));ea.responseType="text";ea.withCredentials=this.Yi();ea.addEventListener("load",function(){ea.readyState===
ea.DONE&&200===ea.status&&y.pf.resolve({FF:ea.response,zI:oa})});ea.addEventListener("error",function(){y.pf.reject(ea.statusText+" "+JSON.stringify(ea))});ea.send()}break;case "image":var sa=this.af[ba.p];ka?sa.promise.reject(ka):fa(ba,ha,sa)&&(sa.result=ba,sa.result.url=Object(x.a)(y.se+"../"+encodeURI(sa.result.url)),sa.resolve(sa.result));break;case "tiles":sa=ba.rID;ia=this.Ke[sa];this.Ke[sa]=null;this.Aw.push(sa);if(ka)ia.reject(ka);else if(fa(ba,ha,ia)){for(ka=0;ka<ba.tiles.length;ka++)ba.tiles[ka]=
Object(x.a)(y.se+"../"+encodeURI(ba.tiles[ka]));ia.resolve(ba)}break;case "text":sa=this.eg[ba.p];if(ka)sa.reject(ka);else if(fa(ba,ha,sa)){sa.QO();var na=new XMLHttpRequest;ba=Object(x.a)(y.se+"../"+encodeURI(ba.url));na.open("GET",ba);na.withCredentials=this.Yi();na.addEventListener("load",function(){na.readyState===na.DONE&&200===na.status&&(sa.result=JSON.parse(na.response),sa.resolve(sa.result))});na.addEventListener("error",function(za){sa.reject(na.statusText+" "+JSON.stringify(za))});na.send()}break;
case "progress":"loading"===ba.t&&y.trigger(b.a.Events.DOCUMENT_LOADING_PROGRESS,[ba.bytes,ba.total])}!ha&&h.echo&&h&&"apstring2xod"==h.echo.t&&(h=h.echo.reqID)&&y.Rh[h].reject("Message unhandled by server")},oK:function(){this.VC(this.mk);return this.mk.promise},cZ:function(h){var y=this,ba=new XMLHttpRequest,ka=Object(x.a)(this.se+"aul")+"&id="+this.id,ha=new FormData,ia={};h=pd(h.body);for(var ea=h.next();!ea.done;ea=h.next())ea=ea.value,ia[ea.id]=ea.JA.w+";"+ea.JA.h,ha.append(ea.id,ea.JA.dataString);
ia={t:"apstring2xod",reqID:this.xM++,parts:ia};var oa=this.dB(ia);ha.append("msg",JSON.stringify(oa));y.Rh[oa.reqID]=ja();ba.open("POST",ka);ba.withCredentials=y.Yi;ka=new Promise(function(sa,na){ba.onreadystatechange=function(){4===ba.readyState&&(200===ba.status?sa():na("An error occurred while sending down appearance strings to the server"))}});ba.send(ha);return ka.then(function(){return y.Rh[oa.reqID].promise})},bZ:function(){this.pf||(this.pf=ja(),this.pf.request={t:"annots"},this.Ge(this.pf.request));
return this.pf.promise},zy:function(h){this.af[h]||(this.af[h]=ja(),this.af[h].request={t:"image",p:h},this.Ge(this.af[h].request));return this.af[h].promise},l5:function(h){this.eg[h]||(this.eg[h]=ja(),this.eg[h].request={t:"text",p:h},this.Ge(this.eg[h].request));return this.eg[h].promise},m5:function(h,y,ba,ka){var ha=this.Ke.length;this.Aw.length&&(ha=this.Aw.pop());this.Ke[ha]=ja();this.Ke[ha].request={t:"tiles",p:h,z:y,r:ba,size:ka,rID:ha};this.Ge(this.Ke[ha].request);return this.Ke[ha].promise},
rO:function(){this.re||(this.re=ja(),this.re.request={t:"pdf"},this.oB?this.re.resolve({url:this.uB}):this.Ge(this.re.request));return this.re.promise},GK:function(h){var y=this,ba=new XMLHttpRequest,ka=Object(x.a)(this.se+"aul")+"&id="+this.id,ha=new FormData,ia={};h.annots&&(ia.annots="xfdf");h.watermark&&(ia.watermark="png");h.redactions&&(ia.redactions="redact");ia={t:"docmod",reqID:this.xM++,parts:ia};h.print&&(ia.print=!0);var ea=this.dB(ia);ha.append("msg",JSON.stringify(ea));return Promise.all([h.annots,
h.watermark,h.redactions].map(function(oa){return Promise.resolve(oa)})).then(function(oa){var sa=oa[0],na=oa[1],za=oa[2];sa&&ha.append("annots",sa);na&&ha.append("watermark",oa.watermark);za&&ha.append("redactions",za);y.Rh[ea.reqID]=ja();ba.open("POST",ka);ba.withCredentials=y.Yi;oa=new Promise(function(ta,ua){ba.onreadystatechange=function(){4===ba.readyState&&(200===ba.status?ta():ua("An error occurred while sending down annotation data to the server"))}});ba.send(ha);return oa.then(function(){return y.Rh[ea.reqID].promise})})},
cL:function(){this.fd||(this.fd=ja(),this.fd.request={t:"xod",noCreate:!0},this.Ge(this.fd.request));return this.fd.promise},n5:function(){this.wd||(this.wd=ja(),this.wd.request={t:"xod"},this.Ge(this.wd.request));return this.wd.promise},Xk:function(){return!0},request:function(){},MN:function(){},abort:function(){for(var h=0;h<this.Ke.length;h++)this.Ke[h]&&(this.Ke[h].resolve(null),this.Ke[h]=null,this.Aw.push(h));this.close()},Jy:function(h){this.Fe=this.Fe||{};this.Fe.headers=h},cba:function(){return this.Fe?
Object(ca.omit)(this.Fe.headers,["Cookie","cookie"]):null},qn:function(h){this.Fe=this.Fe||{};this.Fe.internal=this.Fe.internal||{};this.Fe.internal.withCredentials=h},Yi:function(){return this.Fe&&this.Fe.internal?this.Fe.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(Ca.a)(pa);Object(a.a)(pa);Object(a.b)(pa);va["default"]=pa},353:function(Ca,va,aa){function pa(z,w,r){function b(e,f){function x(za){h().then(function(ta){ea&&!oa?setTimeout(function(){x(za)},
1):ta.send(JSON.stringify(za))})}function n(za,ta,ua,xa){var qa=window.createPromiseCapability(),ya=!1,Aa=qa;ka=za;ha=ta;ia=ua;ba=null;xa&&(za=Object(fa.a)("wvsQueryParameters"),za.bcid=Object(la.i)(8),Object(fa.b)("wvsQueryParameters",za));try{za=sa?na+"/"+sa:na+"/ws";za=Object(ca.a)(za);var Ha=new WebSocket(za);Ha.onopen=function(){qa.resolve();ya=!0;qa=null;ea=!1;y.resolve(Ha);ha&&ha()};Ha.onerror=function(Oa){ea=oa=!0;qa&&qa.reject(Oa);ba&&ba.reject()};Ha.onclose=function(){y=window.createPromiseCapability();
ea=!0;ba||(ba=window.createPromiseCapability());ba.resolve();ia&&ia();ka&&ya&&ka({t:"health",data:{unhealthy:!0,isDead:!0}})};Ha.onmessage=function(Oa){Oa&&Oa.data&&(Oa=JSON.parse(Oa.data),Oa.hb?x({hb:!0}):Oa.end?close():ka(Oa))}}catch(Oa){qa.reject(Oa),qa=null}return Aa.promise}function h(){ea&&ka&&n(ka);return y.promise}var y=window.createPromiseCapability(),ba=null,ka,ha,ia=null,ea=!1,oa=!1,sa=f,na=function(za){var ta=za.indexOf("://"),ua="ws://";0>ta?ta=0:(5===ta&&(ua="wss://"),ta+=3);var xa=
za.lastIndexOf("/");0>xa&&(xa=za.length);return ua+za.slice(ta,xa)}(e);return{send:x,gF:n,CB:function(){return ba?ba.promise:h().then(function(za){ba=window.createPromiseCapability();ka=null;za.close();return ba.promise})}}}function a(e){var f=e.lastIndexOf("/");0>f&&(f=e.length);return e.slice(0,f)}return window.WebSocket&&!r?b(z,w):function(e,f){function x(za){(ia?ia.promise:Promise.resolve(ha)).then(function(ta){var ua=new XMLHttpRequest,xa=ka?ba+"/"+ka+"pf":ba+"/pf";xa=Object(ca.a)(xa)+"&id="+
ta;ta=new FormData;ta.append("data",JSON.stringify(za));ua.open("POST",xa);ua.withCredentials=!0;ua.send(ta)})}function n(){ha=0;ia||(ia=window.createPromiseCapability())}function h(){y=new XMLHttpRequest;var za=ba+"/pf";za+=0!==ha?"?id="+ha+"&uc="+na:"?uc="+na;na++;y.open("GET",za,!0);y.withCredentials=!0;y.setRequestHeader("Cache-Control","no-cache");y.setRequestHeader("X-Requested-With","XMLHttpRequest");var ta=y,ua=!1;y.onreadystatechange=function(){a:if(3<=ta.readyState&&!ua){try{var xa=ta.responseText.length}catch(Aa){Object(ja.g)("caught exception");
break a}if(0<xa)try{var qa=ta.responseText.split("\n");for(qa[qa.length-1]&&qa.pop();0<qa.length&&3>qa[qa.length-1].length;)"]"===qa.pop()&&n();0<qa.length&&3>qa[0].length&&qa.shift();for(xa=0;xa<qa.length;++xa)qa[xa].endsWith(",")&&(qa[xa]=qa[xa].substr(0,qa[xa].length-1));0===ha&&0<qa.length&&(ha=JSON.parse(qa.shift()).id,xa=ia,ia=null,xa.resolve(ha));var ya;for(xa=0;xa<qa.length;++xa)(ya=JSON.parse(qa[xa]))&&ya.end?close():ya&&ya.hb&&ya.id===ha?x({hb:!0}):sa(ya)}catch(Aa){}ea||(ua=!0,h())}};y.send()}
var y,ba=a(e),ka=f,ha=0,ia=window.createPromiseCapability(),ea=!1,oa=null,sa=null,na=0;return{send:x,gF:function(za,ta,ua){sa=za;oa=ua;ea=!1;n();h();ta&&ta();return Promise.resolve()},CB:function(){n();sa=null;ea=!0;oa&&oa();y.abort();return Promise.resolve()}}}(z,w)}aa.d(va,"a",function(){return pa});var ja=aa(1),la=aa(31),fa=aa(37),ca=aa(126)}}]);}).call(this || window)
